{% extends 'base.html' %}
{##}
{#{% block scripts %}#}
{#    <!-- block.super will get the content of the block from the parent template -->#}
{#    {{ block.super }}#}
{#    <script src="{% static 'js/milk.js' %}"></script>#}
{#{% endblock %}#}

{% block head %}

    <style>
        #progressbar li {
            list-style-type: none;
            color: #000000;
            text-transform: uppercase;
            font-size: 9px;
            width: 14.2%;
            float: left;
            position: relative;
            letter-spacing: 1px;
        }
    </style>
{% endblock %}

{% block toggle %}
    {{ block.super }}
    <ul class="nav navbar-nav navbar-right">
        <li><a href="{% url 'migrants_list' %}">Список мигрантов</a></li>
    </ul>
{% endblock %}

{% load static %}

{% block content %}
    <div class="row">
        <div>
            <form id="msform" method="post" enctype="multipart/form-data" regions-url="{% url 'migrant_regions_list' %}"
                  novalidate>
                {% csrf_token %}
                <!-- progressbar -->
                <ul id="progressbar">
                    <li class="active">Общая информация</li>
                    <li>Информация о пострадавшем/ей (пострадавших)</li>
                    <li>Кем нарушены права</li>
                    <li>Описание кейса</li>
                    <li>Кейсы, связанные с данной ситуацией</li>
                    <li>Вопросы для сбора информации</li>
                    <li>Нарушения связанные с COVID-19</li>
                </ul>
                <!-- fieldsets -->
                <fieldset id='id_general_info'>
                    <h2 class="fs-title">Общая информация</h2>
                    <br>
                    {#                <h3 class="fs-subtitle">Tell us something more about you</h3>#}


                    <div class="form-group">
                        {{ form.case_name.label_tag }}{{ form.case_name }}
                        {% if form.case_name.errors %}
                            <div class="invalid_feedback alert alert-danger">
                                {{ form.case_name.errors }}
                            </div>
                        {% endif %}
                    </div>
                    <div class="form-group">
                        {{ form.country.label_tag }}{{ form.country }}
                        {% if form.country.errors %}
                            <div class="invalid_feedback alert alert-danger">
                                {{ form.country.errors }}
                            </div>
                        {% endif %}
                    </div>
                    <div class="form-group">
                        {{ form.region.label_tag }}{{ form.region }}
                        {% if form.region.errors %}
                            <div class="invalid_feedback alert alert-danger">
                                {{ form.region.errors }}
                            </div>
                        {% endif %}
                    </div>

                    <div class="form-group">
                        {{ form.victim_status.label_tag }}
                        {{ form.victim_status }}
                        {% if form.victim_status.errors %}
                            <div class="invalid_feedback alert alert-danger">
                                {{ form.victim_status.errors }}
                            </div>
                        {% endif %}
                    </div>

                    <div class="form-group">
                        {{ form.banOnEntry.label_tag }}
                        {{ form.banOnEntry }}
                        <div class="invalid_feedback">
                            {{ form.banOnEntry.errors }}
                        </div>
                    </div>

                    <div class="form-group">
                        {{ form.banned_country.label_tag }}
                        {{ form.banned_country }}
                        <div class="invalid_feedback">
                            {{ form.banned_country.errors }}
                        </div>
                    </div>

                    <div class="form-group">
                        {{ form.banOnEntryAnother.label_tag }}
                        {{ form.banOnEntryAnother }}
                        <div class="invalid_feedback">
                            {{ form.banOnEntryAnother.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.source.label_tag }}
                        {{ form.source }}
                        <div class="invalid_feedback">
                            {{ form.source.errors }}
                        </div>
                    </div>

                    <div class="panel panel-default" id="div_media">
                        <div class="panel-heading">Информация про СМИ</div>
                        <div class="panel-body">
                            <div class="form-group">
                                {{ form.source_url.label_tag }}
                                {{ form.source_url }}
                                <div class="invalid_feedback">
                                    {{ form.source_url.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ form.source_content.label_tag }}
                                {{ form.source_content }}
                                <div class="invalid_feedback">
                                    {{ form.source_content.errors }}
                                </div>
                            </div>
                        </div>
                    </div>


                    <div class="form-group">
                        {{ form.violated_right.label_tag }}
                        {{ form.violated_right }}
                        <div class="invalid_feedback">
                            {{ form.violated_right.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.violatedRightAnother.label_tag }}
                        {{ form.violatedRightAnother }}
                        <div class="invalid_feedback">
                            {{ form.violatedRightAnother.errors }}
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Дата нарушения</label> <br>
                        <label for="exact"> Точная <input id="exact" onchange="checkIntrud(this)" type="radio"
                                                          name="intrud" value="1"></label>
                        <label for="interval"> Интервал <input id="interval" onchange="checkIntrud(this)" type="radio"
                                                               name="intrud" value="2" checked></label>
                    </div>

                    <div class="form-group">
                        {{ form.start_date.label_tag }}
                        {{ form.start_date }}
                        <div class="invalid_feedback">
                            {{ form.start_date.errors }}
                        </div>
                    </div>

                    <div class="form-group">
                        {{ form.end_date.label_tag }}
                        {{ form.end_date }}
                        <div class="invalid_feedback">
                            {{ form.end_date.errors }}
                        </div>
                    </div>

                    <input type="button" onclick="validate('id_general_info')" class="action-button" value="Следующий"/>
                    <input type="button" name="next" class="next action-button d-none" value="Следующий"/>
                </fieldset>
                <fieldset id='id_victim_fieldset'>
                    <h2 class="fs-title">Информация о пострадавшем/ей (пострадавших)</h2>
                    <br>
                    {#                <h3 class="fs-subtitle">Your presence on the social network</h3>#}
                    <div class="form-group">
                        {{ form.victim.label_tag }}
                        {{ form.victim }}
                        <div class="invalid_feedback">
                            {{ form.victim.errors }}
                        </div>
                    </div>

                    <div class="panel panel-default" id="div_individual">
                        <div class="panel-heading">Информация о физическом лице</div>
                        <div class="panel-body">

                            <div class="form-group">
                                {{ individualForm.is_anonim.label_tag }}
                                {{ individualForm.is_anonim }}
                                <div class="invalid_feedback">
                                    {{ individualForm.is_anonim.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.name.label_tag }}
                                {{ individualForm.name }}
                                <div class="invalid_feedback">
                                    {{ individualForm.name.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.gender.label_tag }}
                                {{ individualForm.gender }}
                                <div class="invalid_feedback">
                                    {{ individualForm.gender.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.gender_another.label_tag }}
                                {{ individualForm.gender_another }}
                                <div class="invalid_feedback">
                                    {{ individualForm.gender_another.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.contacts.label_tag }}
                                {{ individualForm.contacts }}
                                <div class="invalid_feedback">
                                    {{ individualForm.contacts.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.education.label_tag }}
                                {{ individualForm.education }}
                                <div class="invalid_feedback">
                                    {{ individualForm.education.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.individual_age.label_tag }}
                                {{ individualForm.individual_age }}
                                <div class="invalid_feedback">
                                    {{ individualForm.individual_age.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.individual_country.label_tag }}
                                {{ individualForm.individual_country }}
                                <div class="invalid_feedback">
                                    {{ individualForm.individual_country.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.countryAnother.label_tag }}
                                {{ individualForm.countryAnother }}
                                <div class="invalid_feedback">
                                    {{ individualForm.countryAnother.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.city_name.label_tag }}
                                {{ individualForm.city_name }}
                                <div class="invalid_feedback">
                                    {{ individualForm.city_name.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.countryFrom.label_tag }}
                                {{ individualForm.countryFrom }}
                                <div class="invalid_feedback">
                                    {{ individualForm.countryFrom.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.countryFromAnother.label_tag }}
                                {{ individualForm.countryFromAnother }}
                                <div class="invalid_feedback">
                                    {{ individualForm.countryFromAnother.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.city_name_from.label_tag }}
                                {{ individualForm.city_name_from }}
                                <div class="invalid_feedback">
                                    {{ individualForm.city_name_from.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.wayOfArrival.label_tag }}
                                {{ individualForm.wayOfArrival }}
                                <div class="invalid_feedback">
                                    {{ individualForm.wayOfArrival.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.wayOfArrivalAnother.label_tag }}
                                {{ individualForm.wayOfArrivalAnother }}
                                <div class="invalid_feedback">
                                    {{ individualForm.wayOfArrivalAnother.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.wayOfFindingWork.label_tag }}
                                {{ individualForm.wayOfFindingWork }}
                                <div class="invalid_feedback">
                                    {{ individualForm.wayOfFindingWork.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.wayOfFindingWorkAnother.label_tag }}
                                {{ individualForm.wayOfFindingWorkAnother }}
                                <div class="invalid_feedback">
                                    {{ individualForm.wayOfFindingWorkAnother.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.hasRegistration.label_tag }}
                                {{ individualForm.hasRegistration }}
                                <div class="invalid_feedback">
                                    {{ individualForm.hasRegistration.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.tradeUnionMembership.label_tag }}
                                {{ individualForm.tradeUnionMembership }}
                                <div class="invalid_feedback">
                                    {{ individualForm.tradeUnionMembership.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.experience.label_tag }}
                                {{ individualForm.experience }}
                                <div class="invalid_feedback">
                                    {{ individualForm.experience.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.hasAgreement.label_tag }}
                                {{ individualForm.hasAgreement }}
                                <div class="invalid_feedback">
                                    {{ individualForm.hasAgreement.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.agreementDetailYes.label_tag }}
                                {{ individualForm.agreementDetailYes }}
                                <div class="invalid_feedback">
                                    {{ individualForm.agreementDetailYes.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.agreementDetailNo.label_tag }}
                                {{ individualForm.agreementDetailNo }}
                                <div class="invalid_feedback">
                                    {{ individualForm.agreementDetailNo.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.agreementLang.label_tag }}
                                {{ individualForm.agreementLang }}
                                <div class="invalid_feedback">
                                    {{ individualForm.agreementLang.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.understoodTheContents.label_tag }}
                                {{ individualForm.understoodTheContents }}
                                <div class="invalid_feedback">
                                    {{ individualForm.understoodTheContents.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.workBookStatus.label_tag }}
                                {{ individualForm.workBookStatus }}
                                <div class="invalid_feedback">
                                    {{ individualForm.workBookStatus.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.workingDayDuration.label_tag }}
                                {{ individualForm.workingDayDuration }}
                                <div class="invalid_feedback">
                                    {{ individualForm.workingDayDuration.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.hasOverResponsibilities.label_tag }}
                                {{ individualForm.hasOverResponsibilities }}
                                <div class="invalid_feedback">
                                    {{ individualForm.hasOverResponsibilities.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ individualForm.wayOfGettingSalary.label_tag }}
                                {{ individualForm.wayOfGettingSalary }}
                                <div class="invalid_feedback">
                                    {{ individualForm.wayOfGettingSalary.errors }}
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="panel panel-default" id="div_group">
                        <div class="panel-heading">Информация про группу лиц</div>
                        <div class="panel-body">
                            <div class="form-group">
                                {{ groupForm.amount.label_tag }}
                                {{ groupForm.amount }}
                                <div class="invalid_feedback">
                                    {{ groupForm.amount.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ groupForm.groupType.label_tag }}
                                {{ groupForm.groupType }}
                                <div class="invalid_feedback">
                                    {{ groupForm.groupType.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ groupForm.workDescription.label_tag }}
                                {{ groupForm.workDescription }}
                                <div class="invalid_feedback">
                                    {{ groupForm.workDescription.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ groupForm.membership.label_tag }}
                                {{ groupForm.membership }}
                                <div class="invalid_feedback">
                                    {{ groupForm.membership.errors }}
                                </div>
                            </div>
                        </div>
                    </div>
                    <input type="button" name="previous" class="previous action-button-previous" value="Предыдущий"/>
                    {#                    <input type="button" name="next" class="next action-button" value="Следующий"/>#}
                    <input type="button" onclick="validate('id_victim_tab')" class="action-button" value="Следующий"/>
                    <input type="button" id="btnNextFromVictim" name="next" class="next action-button d-none"
                           value="Следующий"/>
                </fieldset>
                <fieldset id='id_intruder_fieldset'>
                    <h2 class="fs-title">Кем нарушены права</h2>
                    <br>
                    {#                <h3 class="fs-subtitle">Your presence on the social network</h3>#}
                    <div class="form-group">
                        {{ form.intruder.label_tag }}
                        {{ form.intruder }}
                        <div class="invalid_feedback">
                            {{ form.intruder.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.government_agency_name.label_tag }}
                        {{ form.government_agency_name }}
                        <div class="invalid_feedback">
                            {{ form.government_agency_name.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.local_agency_name.label_tag }}
                        {{ form.local_agency_name }}
                        <div class="invalid_feedback">
                            {{ form.local_agency_name.errors }}
                        </div>
                    </div>

                    <div class="form-group">
                        {{ form.police_agency_name.label_tag }}
                        {{ form.police_agency_name }}
                        <div class="invalid_feedback">
                            {{ form.police_agency_name.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.control_agency_name.label_tag }}
                        {{ form.control_agency_name }}
                        <div class="invalid_feedback">
                            {{ form.control_agency_name.errors }}
                        </div>
                    </div>

                    <div class="panel panel-default" id="div_company">
                        <div class="panel-heading">Информации о компании</div>
                        <div class="panel-body">
                            <div class="form-group">
                                {{ companyForm.company_name.label_tag }}
                                {{ companyForm.company_name }}
                                <div class="invalid_feedback">
                                    {{ companyForm.company_name.errors }}
                                </div>
                            </div>

                            <div class="form-group">
                                {{ companyForm.address.label_tag }}
                                {{ companyForm.address }}
                                <div class="invalid_feedback">
                                    {{ companyForm.address.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ companyForm.ownership.label_tag }}
                                {{ companyForm.ownership }}
                                <div class="invalid_feedback">
                                    {{ companyForm.ownership.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ companyForm.country_from.label_tag }}
                                {{ companyForm.country_from }}
                                <div class="invalid_feedback">
                                    {{ companyForm.country_from.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ companyForm.is_tnk_member.label_tag }}
                                {{ companyForm.is_tnk_member }}
                                <div class="invalid_feedback">
                                    {{ companyForm.is_tnk_member.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ companyForm.tnk_name.label_tag }}
                                {{ companyForm.tnk_name }}
                                <div class="invalid_feedback">
                                    {{ companyForm.tnk_name.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ companyForm.branch.label_tag }}
                                {{ companyForm.branch }}
                                <div class="invalid_feedback">
                                    {{ companyForm.branch.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ companyForm.product_type.label_tag }}
                                {{ companyForm.product_type }}
                                <div class="invalid_feedback">
                                    {{ companyForm.product_type.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ companyForm.company_experience.label_tag }}
                                {{ companyForm.company_experience }}
                                <div class="invalid_feedback">
                                    {{ companyForm.company_experience.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ companyForm.emp_count.label_tag }}
                                {{ companyForm.emp_count }}
                                <div class="invalid_feedback">
                                    {{ companyForm.emp_count.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ companyForm.additional.label_tag }}
                                {{ companyForm.additional }}
                                <div class="invalid_feedback">
                                    {{ companyForm.additional.errors }}
                                </div>
                            </div>

                        </div>
                    </div>

                    <div class="panel panel-default" id="div_entrepreneur">
                        <div class="panel-heading">Информация о работодателе</div>
                        <div class="panel-body">
                            <div class="form-group">
                                {{ entrepreneurForm.entrepreneur_is_anonim.label_tag }}
                                {{ entrepreneurForm.entrepreneur_is_anonim }}
                                <div class="invalid_feedback">
                                    {{ entrepreneurForm.entrepreneur_is_anonim.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ entrepreneurForm.entrepreneur_name.label_tag }}
                                {{ entrepreneurForm.entrepreneur_name }}
                                <div class="invalid_feedback">
                                    {{ entrepreneurForm.entrepreneur_name.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ entrepreneurForm.entrepreneur_age.label_tag }}
                                {{ entrepreneurForm.entrepreneur_age }}
                                <div class="invalid_feedback">
                                    {{ entrepreneurForm.entrepreneur_age.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ entrepreneurForm.entrepreneur_gender.label_tag }}
                                {{ entrepreneurForm.entrepreneur_gender }}
                                <div class="invalid_feedback">
                                    {{ entrepreneurForm.entrepreneur_gender.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ entrepreneurForm.entrepreneur_address.label_tag }}
                                {{ entrepreneurForm.entrepreneur_address }}
                                <div class="invalid_feedback">
                                    {{ entrepreneurForm.entrepreneur_address.errors }}
                                </div>
                            </div>
                            <div class="form-group">

                                <label for="id_entrepreneur_workPurpose">
                                    {{ entrepreneurForm.entrepreneur_workPurpose.label_tag }}
                                </label>
                                {{ entrepreneurForm.entrepreneur_workPurpose }}
                                <div class="invalid_feedback">
                                    {{ entrepreneurForm.entrepreneur_workPurpose.errors }}
                                </div>

                            </div>
                            <div class="form-group">
                                {{ entrepreneurForm.entrepreneur_emp_count.label_tag }}
                                {{ entrepreneurForm.entrepreneur_emp_count }}
                                <div class="invalid_feedback">
                                    {{ entrepreneurForm.entrepreneur_emp_count.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ entrepreneurForm.entrepreneur_doAgreement.label_tag }}
                                {{ entrepreneurForm.entrepreneur_doAgreement }}
                                <div class="invalid_feedback">
                                    {{ entrepreneurForm.entrepreneur_doAgreement.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ entrepreneurForm.entrepreneur_payWay.label_tag }}
                                {{ entrepreneurForm.entrepreneur_payWay }}
                                <div class="invalid_feedback">
                                    {{ entrepreneurForm.entrepreneur_payWay.errors }}
                                </div>
                            </div>
                            <div class="form-group">

                                <label for="id_entrepreneur_hireWay">
                                    {{ entrepreneurForm.entrepreneur_hireWay.label_tag }}
                                </label>
                                {{ entrepreneurForm.entrepreneur_hireWay }}
                                <div class="invalid_feedback">
                                    {{ entrepreneurForm.entrepreneur_hireWay.errors }}
                                </div>
                            </div>
                            <div class="form-group">
                                {{ entrepreneurForm.entrepreneur_hireWayAnother.label_tag }}
                                {{ entrepreneurForm.entrepreneur_hireWayAnother }}
                                <div class="invalid_feedback">
                                    {{ entrepreneurForm.entrepreneur_hireWayAnother.errors }}
                                </div>
                            </div>
                        </div>
                    </div>
                    <input type="button" name="previous" class="previous action-button-previous" value="Предыдущий"/>
                    {#                    <input type="button" name="next" class="next action-button" value="Следующий"/>#}
                    <input type="button" onclick="validate('id_intruder_tab')" class="action-button" value="Следующий"/>
                    <input type="button" id="btnNextFromIntruder" name="next" class="next action-button d-none"
                           value="Следующий"/>
                </fieldset>
                <fieldset id='id_case_desc_fieldset'>
                    <h2 class="fs-title">Описание кейса</h2>
                    <br>
                    {#                <h3 class="fs-subtitle">Your presence on the social network</h3>#}
                    <div class="form-group">
                        {{ form.case_additional.label_tag }}
                        {{ form.case_additional }}
                        <div class="invalid_feedback">
                            {{ form.case_additional.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.story.label_tag }}
                        {{ form.story }}
                        <div class="invalid_feedback">
                            {{ form.story.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.actions.label_tag }}
                        {{ form.actions }}
                        <div class="invalid_feedback">
                            {{ form.actions.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.final.label_tag }}
                        {{ form.final }}
                        <div class="invalid_feedback">
                            {{ form.final.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.violation_nature.label_tag }}
                        {{ form.violation_nature }}
                        <div class="invalid_feedback">
                            {{ form.violation_nature.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.rights_state.label_tag }}
                        {{ form.rights_state }}
                        <div class="invalid_feedback">
                            {{ form.rights_state.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.rights_state_another.label_tag }}
                        {{ form.rights_state_another }}
                        <div class="invalid_feedback">
                            {{ form.rights_state_another.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.victim_situation.label_tag }}
                        {{ form.victim_situation }}
                        <div class="invalid_feedback">
                            {{ form.victim_situation.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.victim_situation_another.label_tag }}
                        {{ form.victim_situation_another }}
                        <div class="invalid_feedback">
                            {{ form.victim_situation_another.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.tradeUnionSituation.label_tag }}
                        {{ form.tradeUnionSituation }}
                        <div class="invalid_feedback">
                            {{ form.tradeUnionSituation.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.tradeUnionSituation_another.label_tag }}
                        {{ form.tradeUnionSituation_another }}
                        <div class="invalid_feedback">
                            {{ form.tradeUnionSituation_another.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.tradeUnionCount.label_tag }}
                        {{ form.tradeUnionCount }}
                        <div class="invalid_feedback">
                            {{ form.tradeUnionCount.errors }}
                        </div>
                    </div>

                    <input type="button" name="previous" class="previous action-button-previous" value="Предыдущий"/>
                    {#                    <input type="button" name="next" class="next action-button" value="Следующий"/>#}
                    <input type="button" onclick="validate('id_case_description_tab')" class="action-button"
                           value="Следующий"/>
                    <input type="button" id="btnNextFromCaseDesc" name="next" class="next action-button d-none"
                           value="Следующий"/>
                </fieldset>
                <fieldset id='id_files_fieldset'>
                    <h2 class="fs-title">Кейсы, связанные с данной ситуацией</h2>
                    <br>
                    {#                <h3 class="fs-subtitle">Your presence on the social network</h3>#}
                    <div class="form-group">
                        {{ photoForm.photo.label_tag }}
                        {{ photoForm.photo }}
                        <div class="invalid_feedback">
                            {{ photoForm.photo.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ fileForm.file.label_tag }}
                        {{ fileForm.file }}
                        <div class="invalid_feedback">
                            {{ fileForm.file.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.case_additional_info.file.label_tag }}
                        {{ form.case_additional_info.file }}
                        <div class="invalid_feedback">
                            {{ form.case_additional_info.file.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.case_additional_info.label_tag }}
                        {{ form.case_additional_info }}
                        <div class="invalid_feedback">
                            {{ form.case_additional_info.errors }}
                        </div>
                    </div>
                    <input type="button" name="previous" class="previous action-button-previous" value="Предыдущий"/>
                    <input type="button" onclick="validate('id_documents')" class="action-button" value="Следующий"/>
                    <input type="button" id="btnNextFromFileTab" name="next" class="next action-button d-none"
                           value="Следующий"/>

                </fieldset>
                <fieldset id='id_collect_info_fieldset'>
                    <h2 class="fs-title">Вопросы для сбора информации</h2>
                    <br>
                    {#                <h3 class="fs-subtitle">Your presence on the social network</h3>#}
                    <div class="form-group">
                        {{ form.frequent_problems.label_tag }}
                        {{ form.frequent_problems }}
                        <div class="invalid_feedback">
                            {{ form.frequent_problems.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.decision.label_tag }}
                        {{ form.decision }}
                        <div class="invalid_feedback">
                            {{ form.decision.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.advice.label_tag }}
                        {{ form.advice }}
                        <div class="invalid_feedback">
                            {{ form.advice.errors }}
                        </div>
                    </div>
                    <input type="button" name="previous" class="previous action-button-previous" value="Предыдущий"/>
                    {#                    <input type="button" name="next" class="next action-button" value="Следующий"/>#}
                    <input type="button" onclick="validate('id_collect_info_tab')" class="action-button"
                           value="Следующий"/>
                    <input type="button" id="btnNextFromCollectInfo" name="next" class="next action-button d-none"
                           value="Следующий"/>
                </fieldset>
                <fieldset id="id_covid_fieldset">
                    <h2 class="fs-title">Нарушения связанные с COVID-19</h2>
                    {#                <h3 class="fs-subtitle">Fill in your credentials</h3>#}
                    <br>
                    <div class="form-group">
                        {{ form.has_violation_in_covid.label_tag }}
                        {{ form.has_violation_in_covid }}
                        <div class="invalid_feedback">
                            {{ form.has_violation_in_covid.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.violationType.label_tag }}
                        {{ form.violationType }}
                        <div class="invalid_feedback">
                            {{ form.violationType.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.violationType_another.label_tag }}
                        {{ form.violationType_another }}
                        <div class="invalid_feedback">
                            {{ form.violationType_another.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.changesInSalary.label_tag }}
                        {{ form.changesInSalary }}
                        <div class="invalid_feedback">
                            {{ form.changesInSalary.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.changesInSalary_another.label_tag }}
                        {{ form.changesInSalary_another }}
                        <div class="invalid_feedback">
                            {{ form.changesInSalary_another.errors }}
                        </div>
                    </div>
                    <input type="button" name="previous" class="previous action-button-previous" value="Предыдущий"/>
                    <input type="button" onclick="validate('id_covid_tab')" class="action-button" value="Сохранить"/>
                    <input type="submit" id="btnSaveForm" name="submit" class="btn btn-primary action-button d-none"
                           value="Сохранить"/>


                    {#                    <input type="button" id="btnSaveForm" name="next" class="next action-button d-none" value="Следующий"/>#}
                    {#                    #}
                    {#                <input type="submit" value="Сохранить" class="btn btn-primary btn-block">#}
                </fieldset>
            </form>
        </div>
    </div>
    {% block scripts %}
        <!-- block.super will get the content of the block from the parent template -->
        {{ block.super }}


        <script src="{% static 'migrant/js/script.js' %}"></script>

        <script>
            let has_error;

            function validate(id) {
                switch (id) {
                    case 'id_general_info':
                        checkGeneralTab();
                        break;
                    case 'id_documents':
                        checkFilesTab();
                        break;
                    case 'id_victim_tab':
                        checkVictimTab();
                        break;
                    case 'id_intruder_tab':
                        checkIntruderTab();
                        break;
                    case 'id_case_description_tab':
                        checkCaseDescTab();
                        break;
                    case 'id_collect_info_tab':
                        checkCollectInfoTab();
                        break;
                    case 'id_covid_tab':
                        checkCovidForm();
                        break;
                }
            }

            function validate_files_uploaded(id) {
                let field = document.querySelector('#%'.replace('%', id));

                if (field.files.length == 0) {
                    set_error(field, 'files')
                }
            }

            function set_error(field, type = 'empty', amount = 7) {
                if (has_error === false) {
                    field.focus();
                }
                let err;
                switch (type) {
                    case 'length':
                        err = errorMessage('Значение должно состоять как минимум из amount символов!'.replace('amount', amount));
                        break;
                    case 'select':
                        err = errorMessage('Необходимо выбрать значение!');
                        break;
                    case 'empty':
                        err = errorMessage('Значение не может быть пустым!');
                        break;
                    case 'any':
                        err = errorMessage('Необходимо заполнить хотя бы одно поле!');
                        break;
                    case 'files':
                        err = errorMessage('Необходимо прикрепить файлы!');
                        break;
                }

                field.after(err);
                has_error = true
            }

            function is_checked(id) {
                return document.querySelector('#%'.replace('%', id)).checked;
            }

            function get_selected(id) {
                return document.querySelector('#%'.replace('%', id)).value;
            }

            function validate_text_field(id, length = 0) {
                let field = document.querySelector('#%'.replace('%', id));
                if (length > 0) {
                    if (field.value.length < length) {
                        set_error(field, 'length', length);
                    }
                } else {
                    if (field.value === '') {
                        set_error(field, 'empty');
                    }
                }
            }

            function validate_selected(id) {
                let field = document.querySelector('#%'.replace('%', id));
                if (field.value === '') {
                    set_error(field, 'select');
                }
            }

            function clear_errors() {
                document.querySelectorAll(".err").forEach(el => el.remove());
            }

            function checkedAny(checkBoxList) {
                for (let i = 0; i < checkBoxList.length; i++) {
                    if (checkBoxList[i].checked) {
                        return true;
                    }
                }
                return false;
            }

            function validate_checkbox_list(classname, id) {
                let list = document.querySelectorAll('input[name=%]'.replace('%', classname));
                if (!checkedAny(list)) {
                    set_error(document.querySelector('#%'.replace('%', id)), 'select');
                }
            }

            function checkGeneralTab() {
                has_error = false;
                clear_errors();

                let id_case_name = document.querySelector('#id_case_name');
                if (id_case_name.value.length < 3) {
                    set_error(id_case_name, 'length', 3);
                }

                let id_victim_status = document.querySelector('#id_victim_status');
                if (id_victim_status.value === '') {
                    set_error(id_victim_status, 'select');
                }


                validate_selected('id_banOnEntry');

                switch (get_selected('id_banOnEntry')) {
                    case '1':
                        validate_text_field('id_banned_country', 3);
                        break;
                    case '4':
                        validate_text_field('id_banOnEntryAnother', 7);
                        break;
                }

                let id_source = document.querySelectorAll('input[name=source]');

                if (!checkedAny(id_source)) {
                    set_error(document.querySelector('#id_source'), 'select');
                }

                if (document.querySelector('#id_source_1').checked) {
                    let id_source_url = document.querySelector('#id_source_url');
                    let id_source_content = document.querySelector('#id_source_content');

                    if (id_source_url.value === '' && id_source_content.value === '') {
                        set_error(id_source_content, 'any');
                    }

                }

                let id_violated_right = document.querySelectorAll('input[name=violated_right]');
                if (!checkedAny(id_violated_right)) {
                    set_error(document.querySelector('#id_violated_right'), 'select');
                }

                if (document.querySelector('#id_violated_right_13').checked) {
                    let id_violatedRightAnother = document.querySelector('#id_violatedRightAnother');
                    if (id_violatedRightAnother.value.length < 3) {
                        set_error(id_violatedRightAnother, 'length', 3);
                    }
                }

                if (has_error == false) {
                    document.querySelector('.next').click();
                }
            }

            function checkVictimTab() {
                has_error = false;
                clear_errors();

                let id_victim = document.querySelector('#id_victim');
                if (id_victim.value === '') {
                    set_error(id_victim, 'select');
                }

                if (id_victim.value == 2) {
                    let id_amount = document.querySelector('#id_amount');
                    if (id_amount.value === '') {
                        set_error(id_amount, 'empty');
                    }
                    let id_groupType = document.querySelector('#id_groupType');
                    if (id_groupType.value === '') {
                        set_error(id_groupType, 'select');
                    }
                    let id_workDescription = document.querySelector('#id_workDescription');
                    if (id_workDescription.value === '') {
                        set_error(id_workDescription, 'empty');
                    }
                    let id_membership = document.querySelector('#id_membership');
                    if (id_membership.value === '') {
                        set_error(id_membership, 'select');
                    }
                } else if (id_victim.value == 1) {
                    let id_is_anonim = document.querySelector('#id_is_anonim');
                    if (id_is_anonim.value === '') {
                        set_error(id_is_anonim, 'select');
                    }
                    if (id_is_anonim.value == 'NO') {
                        let id_name = document.querySelector('#id_name');
                        if (id_name.value.length < 7) {
                            set_error(id_name, 'length', 7);
                        }
                    }
                    let id_gender = document.querySelector('#id_gender');
                    if (id_gender.value === '') {
                        set_error(id_gender, 'select');
                    }
                    if (id_gender.value == 3) {
                        let id_gender_another = document.querySelector('#id_gender_another');
                        if (id_gender_another.value.length < 3) {
                            set_error(id_gender_another, 'length', 3);
                        }
                    }
                    let id_contacts = document.querySelector('#id_contacts');
                    if (id_contacts.value.length < 7) {
                        set_error(id_contacts, 'length', 7);
                    }

                    let id_education = document.querySelector('#id_education');
                    if (id_education.value === '') {
                        set_error(id_education, 'select');
                    }
                    let id_country = document.querySelector('#id_country');
                    if (id_country.value === '') {
                        set_error(id_country, 'select');
                    }
                    if (id_country.value == 4) {
                        let id_countryFromAnother = document.querySelector('#id_countryFromAnother');
                        if (id_countryFromAnother.value.length < 3) {
                            set_error(id_countryFromAnother, 'length', 3);
                        }
                    }
                    let id_city_name = document.querySelector('#id_city_name');
                    if (id_city_name.value.length < 3) {
                        set_error(id_city_name, 'length', 3);
                    }
                    let id_countryFrom = document.querySelector('#id_countryFrom');
                    if (id_countryFrom.value === '') {
                        set_error(id_countryFrom, 'select');
                    }
                    if (id_countryFrom.value == 4) {
                        let id_countryFromAnother = document.querySelector('#id_countryFromAnother');
                        if (id_countryFromAnother.value.length < 3) {
                            set_error(id_countryFromAnother, 'length', 3);
                        }
                    }
                    let id_city_name_from = document.querySelector('#id_city_name_from');
                    if (id_city_name_from.value.length < 3) {
                        set_error(id_city_name_from, 'length', 3);
                    }
                    let id_wayOfArrival = document.querySelector('#id_wayOfArrival');
                    if (id_wayOfArrival.value === '') {
                        set_error(id_wayOfArrival, 'select');
                    }
                    if (id_wayOfArrival.value == 5) {
                        let id_wayOfArrivalAnother = document.querySelector('#id_wayOfArrivalAnother');
                        if (id_wayOfArrivalAnother.value.length < 7) {
                            set_error(id_wayOfArrivalAnother, 'length', 7);
                        }
                    }
                    let id_wayOfFindingWork = document.querySelector('#id_wayOfFindingWork');
                    if (id_wayOfFindingWork.value === '') {
                        set_error(id_wayOfFindingWork, 'select');
                    }
                    if (id_wayOfFindingWork.value == 8) {
                        let id_wayOfFindingWorkAnother = document.querySelector('#id_wayOfFindingWorkAnother');
                        if (id_wayOfFindingWorkAnother.value.length < 7) {
                            set_error(id_wayOfFindingWorkAnother, 'length', 7);
                        }
                    }
                    let id_hasRegistration = document.querySelector('#id_hasRegistration');
                    if (id_hasRegistration.value === '') {
                        set_error(id_hasRegistration, 'select');
                    }
                    let id_tradeUnionMembership = document.querySelector('#id_tradeUnionMembership');
                    if (id_tradeUnionMembership.value === '') {
                        set_error(id_tradeUnionMembership, 'select');
                    }
                    let id_experience = document.querySelector('#id_experience');
                    if (id_experience.value === '') {
                        set_error(id_experience, 'empty');
                    }
                    let id_hasAgreement = document.querySelector('#id_hasAgreement');
                    if (id_hasAgreement.value === '') {
                        set_error(id_hasAgreement, 'select');
                    }
                    if (id_hasAgreement.value == 'YES') {
                        let id_agreementDetailYes = document.querySelector('#id_agreementDetailYes');
                        if (id_agreementDetailYes.value === '') {
                            set_error(id_agreementDetailYes, 'select');
                        }
                    } else if (id_hasAgreement.value == 'NO') {
                        let id_agreementDetailNo = document.querySelector('#id_agreementDetailNo');
                        if (id_agreementDetailNo.value === '') {
                            set_error(id_agreementDetailNo, 'select');
                        }
                    }
                    let id_agreementLang = document.querySelector('#id_agreementLang');
                    if (id_agreementLang.value === '') {
                        set_error(id_agreementLang, 'length', 3);
                    }
                    let id_understoodTheContents = document.querySelector('#id_understoodTheContents');
                    if (id_understoodTheContents.value === '') {
                        set_error(id_understoodTheContents, 'select');
                    }
                    let id_workBookStatus = document.querySelector('#id_workBookStatus');
                    if (id_workBookStatus.value === '') {
                        set_error(id_workBookStatus, 'select');
                    }
                    let id_workingDayDuration = document.querySelector('#id_workingDayDuration');
                    if (id_workingDayDuration.value === '') {
                        set_error(id_workingDayDuration, 'select');
                    }
                    let id_hasOverResponsibilities = document.querySelector('#id_hasOverResponsibilities');
                    if (id_hasOverResponsibilities.value === '') {
                        set_error(id_hasOverResponsibilities, 'select');
                    }
                    let id_wayOfGettingSalary = document.querySelector('#id_wayOfGettingSalary');
                    if (id_wayOfGettingSalary.value === '') {
                        set_error(id_wayOfGettingSalary, 'select');
                    }

                }

                if (has_error == false) {
                    document.querySelector('#btnNextFromVictim').click();
                }
            }

            function checkIntruderTab() {
                has_error = false;
                clear_errors();
                validate_checkbox_list('intruder', 'id_intruder');

                if (is_checked('id_intruder_0')) {
                    validate_text_field('id_government_agency_name', 0);
                }
                if (is_checked('id_intruder_1')) {
                    validate_text_field('id_local_agency_name', 0);
                }
                if (is_checked('id_intruder_2')) {
                    validate_text_field('id_police_agency_name', 0);
                }
                if (is_checked('id_intruder_3')) {
                    validate_text_field('id_control_agency_name', 0);
                }
                if (is_checked('id_intruder_4')) {
                    validate_text_field('id_company_name', 7);
                    validate_text_field('id_address', 7);
                    validate_selected('id_ownership');
                    validate_text_field('id_branch', 7);
                    validate_text_field('id_product_type', 7);
                    validate_text_field('id_product_type', 7);
                    validate_text_field('id_company_experience', 0);
                    validate_selected('id_emp_count');
                    validate_text_field('id_country_from', 3);
                    validate_text_field('id_additional', 7);
                    validate_selected('id_is_tnk_member');
                    is_tnk = get_selected('id_is_tnk_member');
                    if (is_tnk == 'YES') {
                        validate_text_field('id_tnk_name', 7);
                    }

                }
                if (is_checked('id_intruder_5')) {
                    validate_selected('id_entrepreneur_is_anonim');
                    if (get_selected('id_entrepreneur_is_anonim') == 'NO') {
                        validate_text_field('id_entrepreneur_name', 7);
                    }
                    validate_selected('id_entrepreneur_age');
                    validate_selected('id_entrepreneur_gender');
                    validate_text_field('id_entrepreneur_address', 7);
                    validate_checkbox_list('entrepreneur_workPurpose', 'id_entrepreneur_workPurpose');
                    validate_selected('id_entrepreneur_emp_count');
                    validate_selected('id_entrepreneur_doAgreement');
                    validate_selected('id_entrepreneur_payWay');
                    validate_checkbox_list('entrepreneur_hireWay', 'id_entrepreneur_hireWay');
                    if (get_selected('id_entrepreneur_hireWay_6') == 6) {
                        validate_text_field('id_entrepreneur_hireWayAnother', 7)
                    }
                }

                if (has_error == false) {
                    document.querySelector('#btnNextFromIntruder').click();
                }
            }

            function checkCaseDescTab() {
                has_error = false;
                clear_errors();

                validate_text_field('id_case_additional', 7);
                validate_text_field('id_story', 7);
                validate_text_field('id_actions', 7);
                validate_text_field('id_final', 7);
                validate_selected('id_violation_nature');
                validate_selected('id_rights_state');
                if (get_selected('id_rights_state') == 4) {
                    validate_text_field('id_rights_state_another', 7);
                }
                validate_selected('id_victim_situation');
                if (get_selected('id_victim_situation') == 4) {
                    validate_text_field('id_victim_situation_another', 7);
                }
                if (get_selected("id_tradeUnionMembership") == 1 || get_selected('id_membership') != 2) {
                    validate_selected('id_tradeUnionSituation');
                    if (get_selected('id_tradeUnionSituation') == 4) {
                        validate_text_field('id_tradeUnionSituation_another', 7);
                    }
                    validate_selected('id_tradeUnionCount')
                }

                if (has_error == false) {
                    document.querySelector('#btnNextFromCaseDesc').click();
                }
            }

            function errorMessage(txt) {
                let p = document.createElement('p');
                p.style.color = 'red';
                p.className = 'err';
                p.innerHTML = txt;
                return p;
            }

            function checkFilesTab() {
                has_error = false;
                clear_errors();

                {#validate_files_uploaded('id_photo');#}
                {#validate_files_uploaded('id_file');#}
                {#validate_text_field('id_case_additional_info', 7);#}

                if (has_error == false) {
                    document.querySelector('#btnNextFromFileTab').click();
                }

            }

            function checkCollectInfoTab() {
                has_error = false;
                clear_errors();

                {#validate_text_field('id_frequent_problems', 7);#}
                {#validate_text_field('id_decision', 7);#}
                {#validate_text_field('id_advice', 7);#}


                if (has_error == false) {
                    document.querySelector('#btnNextFromCollectInfo').click();
                }
            }

            function checkCovidForm() {
                has_error = false;
                clear_errors();

                validate_selected('id_has_violation_in_covid');
                validate_selected('id_violationType');
                if (get_selected('id_violationType') == 7) {
                    validate_text_field('id_violationType_another', 7);
                }
                validate_selected('id_changesInSalary');
                if (get_selected('id_changesInSalary') == 5) {
                    validate_text_field('id_changesInSalary_another', 7)
                }

                if (has_error == false) {
                    document.querySelector('#btnSaveForm').click();
                }
            }

            function checkIntrud(e) {
                if (e.value === '1') {
                    document.querySelector('#id_end_date').style.display = 'none';
                    document.querySelector('label[for=id_end_date]').style.display = 'none';
                    document.querySelector('label[for=id_start_date]').style.display = 'none';
                    document.querySelector('#id_end_date').value = '';
                } else if (e.value === '2') {
                    document.querySelector('label[for=id_start_date]').style.display = 'block';
                    document.querySelector('label[for=id_end_date]').style.display = 'block';
                    document.querySelector('#id_end_date').style.display = 'block';
                    document.querySelector('#id_end_date').value = document.querySelector('#id_start_date').value;
                }

            }
        </script>

        <script>
            $("#id_country").change(function () {
                const url = $("#msform").attr("regions-url");  // get the url of the `load_cities` view
                const countryId = $(this).val();  // get the selected country ID from the HTML input

                $.ajax({                       // initialize an AJAX request
                    url: url,                    // set the url of the request (= /persons/ajax/load-cities/ )
                    data: {
                        'country_id': countryId       // add the country id to the GET parameters
                    },
                    success: function (data) {   // `data` is the return of the `load_cities` view function
                        $("#id_region").html(data);  // replace the contents of the city input with the data that came from the server
                        /*
                        let html_data = '<option value="">---------</option>';
                        data.forEach(function (city) {
                            html_data += `<option value="${city.id}">${city.name}</option>`
                        });
                        console.log(html_data);
                        $("#id_city").html(html_data);
                        */
                    }
                });

            });
        </script>

    {% endblock %}

{% endblock %}